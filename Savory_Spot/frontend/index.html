<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="Savory_Spot.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

        <title>Savory Spot</title>
    </head>
    <body>
        <!--Navbar Starts-->
        <div class="background-overlay"></div>
        <nav class="navbar bg-dark border-bottom border-body" data-bs-theme="dark">
            <div class="nav-content">
                <div class="left-content">
                    <ul>               
                        <li><i class="bi bi-fork-knife" style="color: rgb(255, 204, 0); font-size: 2.5rem;"></i></li>
                        <li><h4 style= "color: rgb(255, 204, 0);">Savory Spot</h4></li>                    
                    </ul>
                </div>               
                <div class="right-content">
                    <ul>               
                        <li><a href="#home">HOME</a></li>
                        <li><a href="#menu">MENU</a></li>
                        <li><a href="#services">SERVICES</a></li>                              
                        <li><a href="#reviews">REVIEWS</a></li>
                        <!--li><a href="#book" class="book-link">BOOK A TABLE</button></a></li-->
                        <li><a href="#login"><button type="button" class="btn btn-warning" id = "login">LOG IN</button></a></li>
                        <li><a href="#register"><button type="button" class="btn btn-warning" id = 'register'>REGISTER</button></a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!--Navbar Ends-->
        <!--Welcome Page Starts-->

        <div class="grid-container">
            <div class="item1"> <video class="welcome-video"src="welcomevideo.mp4" autoplay muted loop width="400" height="400"></video></div>
            <div class="item2"><h1 id="home">WELCOME TO SAVORY SPOT!</h1>
                <p class="home-description">
                    At Savory Spot, we bring people together over hearty meals and unforgettable flavors. 
                    From sizzling burgers to handcrafted pastas and wood-fired pizzas, every dish is made with love and fresh ingredients. 
                    Whether you're dining in, ordering out, or planning a cozy evening with friends, we are here to serve up taste, warmth, and satisfaction in every bite.
                </p>
            </div>
        </div>
        <br>
        <!--Welcome Page Ends-->
        <!--Menu Starts-->    
        <div class="menu-items">
            <h2 id="menu">Our Menu</h2>
            <hr>
            <h3>Burger Bliss</h3>
            <div class="burger">
                <div class ="food-card"  id = "chickenburger">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="chickenburger.jpg">               
                            <div class="promo-badge">Buy 1<br>Get 1<br>Free</div>
                        </div>
                        <div class="menu-title">Crispy Chicken Burger</div>
                        <div class="menu-price">
                            <p>MUR 150</p>
                        </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "chickenburger">ORDER NOW</button></li>
                </div>
                <div class="food-card" id = "lambburger">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="lambburger.jpeg">
                        </div>
                        <div class="menu-title">Lamb Burger</div>
                        <div class="menu-price">
                            <p>MUR 200</p>
                        </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "lambburger">ORDER NOW</button></li>
                </div>
                <div class="food-card" id = "vegburger">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="vegburger.jpeg">
                        </div>
                        <div class="menu-title">Veg Burger</div>
                        <div class="menu-price">
                            <p>MUR 100</p>
                        </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning"id = "orderbutton" value = "vegburger">ORDER NOW</button></li>
                </div>
            </div>
            <br>
            <h3>Pizza Corner</h3>
            <div class="pizza">
                <div class="food-card" id = "chickenpizza">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="Chickenpizza.jpg">
                        </div>
                        <div class="menu-title">Creamy Chicken Pizza</div>
                        <div class="menu-price">
                            <p>MUR 250</p>
                        </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "chickenpizza">ORDER NOW</button></li>
                </div>
                <div class="food-card" id = "lambpizza">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="lambpizza.jpg">
                            <div class="promo-badge">Buy 1<br>Get 1<br>Free</div>
                        </div>
                        <div class="menu-title">Lamb Pizza</div>
                        <div class="menu-price">
                            <p>MUR 300</p>
                        </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "lambpizza">ORDER NOW</button></li>
                </div>
                <div class="food-card" id = "vegpizza">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="vegpizza.jpeg">
                        </div>
                        <div class="menu-title">Veg Pizza</div>
                        <div class="menu-price">
                            <p>MUR 150</p>
                        </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "vegpizza">ORDER NOW</button></li>
                </div>
            </div>
            <br>
            <h3>Cozy Pasta</h3>
            <div class="pasta">
                <div class="food-card" id = "chickenpasta">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="chickenpasta.jpg">
                        </div>
                        <div class="menu-title">Chicken Pasta</div>
                        <div class="menu-price">
                            <p>MUR 350</p>
                        </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "chickenpasta">ORDER NOW</button></li>
                </div>
                <div class="food-card" id = "lambpasta">
                    <div class="container">
                        <div class="food-img-bg">
                            <img src="lambpasta.jpg">
                        </div>
                    <div class="menu-title">Lamb Pasta</div>
                    <div class="menu-price">
                        <p>MUR 400</p>
                    </div>
                    </div> 
                    <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "lambpasta">ORDER NOW</button></li>
                </div>
                <div class="food-card" id = "vegpasta">
                <div class="container">
                    <div class="food-img-bg">
                        <img src="vegpasta.jpg">
                        <div class="promo-badge">Buy 1<br>Get 1<br>Free</div>
                    </div>                   
                    <div class="menu-title">Veg Pasta</div>
                    <div class="menu-price">
                        <p>MUR 250</p>
                    </div>
                </div> 
                <li><button type="button" class="btn btn-warning" id = "orderbutton" value = "vegpasta">ORDER NOW</button></li>
                </div>
            </div>

        </div>
        <br>
        <!--Menu Ends-->
        <!--Service Starts-->
        <h2 id="services">Our Services</h2>
        <hr>
        <div class="services">
            <div class="service-card">
                <i class="bi bi-fork-knife"></i>
                <h6>Quality Food</h6>
            </div>   
            <div class="service-card">
                <i class="bi bi-cart-check-fill"></i>
                <h6>Online Order</h6>
            </div>
            <div class="service-card">
                <i class="bi bi-alarm-fill"></i>
                <h6>24/7 Service</h6>
            </div>
            <div class="service-card">
                <i class="bi bi-truck"></i>
                <h6>Free Delivery</h6>
            </div>
        </div>
        <br>
        <!--Service Ends-->
        <!--Reviews Starts-->
        <h2 id="reviews">Client Reviews</h2>
        <hr>
        <div class="reviews-container">
            <div class="reviews-card">
                <div class="reviews-phrases">
                    <p>“Delicious food and fast delivery! Highly recommend.”— Abraham</p>
                </div>
            </div>
            <div class="reviews-card">
                <div class="reviews-phrases">
                    <p>“Amazing flavors and great customer service.Lip-smacking!!!”— Nayar</p>
                </div>
            </div>
            <div class="reviews-card">
                <div class="reviews-phrases">
                    <p>“Affordable prices and top-quality meals every time.”— Nirmal</p>
                </div>
            </div>
            <div class="reviews-card">
                <div class="reviews-phrases">
                    <p>“Love the online ordering system—so easy and convenient!”— Mark</p>
                </div>
            </div>
        </div>
       
    <script>
        var username;
        var allOrders = 'test';

        //event listeners for login and register button from home page
        document.getElementById('login').addEventListener('click', function() 
        {
            window.location.href =  "/login";
        });
        document.getElementById('register').addEventListener('click', function() 
        {
            window.location.href =  "/register";
        });

        window.onload = function() 
        {
            //Get URL query parameters and extract the value of 'username' from the URL, if it exists
            const urlParams = new URLSearchParams(window.location.search);
            username = urlParams.get('username');
            console.log(username);
            let loginButton;
            let registerButton;
            let navbar;
            let welcomeUser;
            let logOut;


            if (username) 
            {
                //Remove the login + register buttons
                loginButton = document.getElementById('login');
                if (loginButton) loginButton.remove();
                registerButton = document.getElementById('register');
                if (registerButton) registerButton.remove();

                //Get the <ul> inside the navbar
                const ul = document.querySelector('.right-content ul');

                // Create a new <li> to welcome the loggedin user, then apped it next to navbar links
                welcomeUser = document.createElement('li');
                welcomeUser.innerText = 'Welcome ' + username;

                welcomeUser.style.color = 'rgb(241, 186, 5)';
                welcomeUser.style.fontWeight = 'bold';
                welcomeUser.style.display = 'inline-block';
                welcomeUser.style.marginLeft = '10px';

                ul.appendChild(welcomeUser);

                // Create the cart <li> + add bootstrap cart icon and append it next to the welcomeuser
                const cartLi = document.createElement('li');
                cartLi.innerHTML = `<a href="#cart" class="btn btn-outline-warning"> <i class="bi bi-cart"></i> Cart</a>`;
                cartLi.style.marginLeft = '10px';
                ul.appendChild(cartLi);

                //Cart button function
                cartLi.addEventListener('click', function() 
                {
                    window.location.href =  `/mycart?allOrders=${allOrders}&username=${username}`;
                });

                //Create a logout button for a logged in user
                logOut = document.createElement('li');
                logOut.innerHTML = '<a href="#logout"><button type="button" class="btn btn-warning" id = "logout">LOG OUT</button></a>'
                ul.appendChild(logOut);

                //redirecting client to main page after clicking on logout
                document.getElementById("logout").addEventListener("click", function() 
                {
                    window.location.href = "/savoryspot";
                });         
            }
        }

        //to obtain the orders of the loggedin user
        let orderButton = document.querySelectorAll('#orderbutton');
        for(let i = 0; i < orderButton.length; i++)
        {
            orderButton[i].addEventListener("click", function()
            {
                if(allOrders == null)
                {
                    allOrders = orderButton[i].value + ',';
                }
                else
                {
                    allOrders += orderButton[i].value + ',';
                }
                if(!username)
                {
                    alert('Please log in or register first');
                }
                else
                {
                    window.location.href = `/orders?menu=${orderButton[i].value}&username=${username}&neworder=${orderButton[i].value}&allOrders=${allOrders}`;
                }
            }
        )};
        
        let menu;
        let removeButton;
        
        //getting parameters from url - changing button from 'ORDER NOW' to 'CANCEL ORDER' upon click
        const urlParams = new URLSearchParams(window.location.search);
        menu = urlParams.get('neworder');
        username = urlParams.get('username');
        allOrders = urlParams.get('allOrders');
        console.log(allOrders)

        if (username && allOrders) 
        { 
            let orderedMenusArr = allOrders.split(",");

            for (let i = 0; i < orderedMenusArr.length; i++)
            {
                menu = orderedMenusArr[i];
                //Remove the order now button and add a remove button
                for(let i = 0; i < orderButton.length; i++)
                {
                    if(orderButton[i].value == menu)
                    {
                        orderButton[i].remove();

                        console.log("the menu is :" + menu)
                        let foodID = document.getElementById(menu);
                        console.log("FoodID is: " + foodID)
                        removeButton = document.createElement('li');
                        removeButton.innerHTML = '<button type="button" class="btn btn-light" id = "cancelorder">CANCEL ORDER</button>'
                        removeButton.value = menu;
                        console.log("remove button is " + removeButton.value)
                        foodID.appendChild(removeButton);

                        removeButton.addEventListener("click", function()
                        {
                            console.log("cancelled order" + menu)
                            window.location.href = `/ordercancelled?menu=${removeButton.value}&username=${username}`;
                        })
                                break;
                    }; 
                }  
            }
        }
    </script>
    </body>
</html>